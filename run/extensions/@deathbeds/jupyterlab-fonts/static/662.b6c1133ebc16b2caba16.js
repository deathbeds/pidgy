"use strict";(self.webpackChunk_deathbeds_jupyterlab_fonts=self.webpackChunk_deathbeds_jupyterlab_fonts||[]).push([[662],{602:(e,t,n)=>{n.d(t,{Z:()=>l});var o=n(584),s=n.n(o),i=n(51),a=n.n(i)()(s());a.push([e.id,".jp-FontsEditor {\n  color: var(--jp-ui-font-color0);\n  overflow-y: auto;\n  background-color: var(--jp-layout-color1);\n}\n\n.jp-FontsEditor-button.jp-mod-styled {\n  font-size: var(--jp-ui-font-size1);\n  background-color: var(--jp-layout-color0);\n  border: solid 1px transparent;\n  white-space: nowrap;\n  flex: 0;\n}\n\n.jp-FontsEditor .lm-CommandPalette-header {\n  margin: 0;\n}\n\n.jp-FontsEditor-enable label {\n  margin: calc(var(--jp-ui-font-size1) / 2) 0 0 var(--jp-ui-font-size1);\n  font-size: var(--jp-ui-font-size1);\n  display: flex;\n  flex-direction: row;\n  align-items: center;\n}\n\n.jp-FontsEditor-button.jp-mod-styled:focus,\n.jp-FontsEditor-button.jp-mod-styled:hover {\n  border-color: var(--jp-border-color1);\n}\n\n.jp-FontsEditor h2 {\n  padding: var(--jp-ui-font-size1);\n  margin: 0;\n  display: flex;\n}\n\n.jp-FontsEditor h2 > label {\n  flex: 1;\n}\n\n.jp-FontsEditor-delete-icon.jp-FontsEditor-button.jp-mod-styled {\n  background-repeat: no-repeat;\n  background-position: center;\n  color: transparent;\n}\n\n.jp-FontsEditor h2 .jp-NotebookIcon {\n  width: var(--jp-ui-font-size2);\n  height: calc(var(--jp-ui-font-size2));\n  display: inline-block;\n  vertical-align: middle;\n  background-repeat: no-repeat;\n}\n\n.jp-FontsEditor-embed {\n  padding: 0;\n  margin: 0;\n}\n\n.jp-FontsEditor-embed li {\n  display: flex;\n  flex-direction: row;\n  list-style: none;\n  align-items: baseline;\n  justify-content: space-between;\n  margin: 0 var(--jp-ui-font-size1);\n}\n\n.jp-FontsEditor-embed li > * {\n  flex: 1;\n  font-size: var(--jp-ui-font-size1);\n}\n\n.jp-FontsEditor-embed li > .jp-FontsEditor-size {\n  flex: 0;\n  padding: 0 var(--jp-ui-font-size1);\n  font-size: var(--jp-ui-font-size0);\n  color: var(--jp-ui-font-color2);\n  white-space: nowrap;\n}\n\n.jp-FontsEditor-field {\n  display: flex;\n  margin: 0 var(--jp-ui-font-size1);\n  align-items: baseline;\n}\n\n.jp-FontsEditor-field label {\n  white-space: nowrap;\n  flex: 0;\n  font-size: var(--jp-ui-font-size1);\n  padding-right: var(--jp-ui-font-size1);\n}\n\n.jp-FontsEditor-field > div {\n  display: flex;\n  flex: 1;\n  flex-direction: row;\n  align-items: baseline;\n}\n.jp-FontsEditor-field > div * {\n  display: block;\n  flex: 1;\n  text-align: right;\n  font-size: var(--jp-ui-font-size1);\n}\n\n.jp-FontsEditor-field select {\n  font-weight: bold;\n  border: none;\n  background: transparent;\n  background-image: var(--jp-ui-select-caret);\n  background-repeat: no-repeat;\n  background-position: 99% center;\n  background-size: 18px;\n  text-align: right;\n  text-align-last: right;\n  margin-left: var(--jp-notebook-padding);\n  padding-right: calc(2 * var(--jp-notebook-padding));\n}\n\n.jp-FontsEditor option {\n  text-align: right;\n}\n","",{version:3,sources:["webpack://./style/editor.css"],names:[],mappings:"AAAA;EACE,+BAA+B;EAC/B,gBAAgB;EAChB,yCAAyC;AAC3C;;AAEA;EACE,kCAAkC;EAClC,yCAAyC;EACzC,6BAA6B;EAC7B,mBAAmB;EACnB,OAAO;AACT;;AAEA;EACE,SAAS;AACX;;AAEA;EACE,qEAAqE;EACrE,kCAAkC;EAClC,aAAa;EACb,mBAAmB;EACnB,mBAAmB;AACrB;;AAEA;;EAEE,qCAAqC;AACvC;;AAEA;EACE,gCAAgC;EAChC,SAAS;EACT,aAAa;AACf;;AAEA;EACE,OAAO;AACT;;AAEA;EACE,4BAA4B;EAC5B,2BAA2B;EAC3B,kBAAkB;AACpB;;AAEA;EACE,8BAA8B;EAC9B,qCAAqC;EACrC,qBAAqB;EACrB,sBAAsB;EACtB,4BAA4B;AAC9B;;AAEA;EACE,UAAU;EACV,SAAS;AACX;;AAEA;EACE,aAAa;EACb,mBAAmB;EACnB,gBAAgB;EAChB,qBAAqB;EACrB,8BAA8B;EAC9B,iCAAiC;AACnC;;AAEA;EACE,OAAO;EACP,kCAAkC;AACpC;;AAEA;EACE,OAAO;EACP,kCAAkC;EAClC,kCAAkC;EAClC,+BAA+B;EAC/B,mBAAmB;AACrB;;AAEA;EACE,aAAa;EACb,iCAAiC;EACjC,qBAAqB;AACvB;;AAEA;EACE,mBAAmB;EACnB,OAAO;EACP,kCAAkC;EAClC,sCAAsC;AACxC;;AAEA;EACE,aAAa;EACb,OAAO;EACP,mBAAmB;EACnB,qBAAqB;AACvB;AACA;EACE,cAAc;EACd,OAAO;EACP,iBAAiB;EACjB,kCAAkC;AACpC;;AAEA;EACE,iBAAiB;EACjB,YAAY;EACZ,uBAAuB;EACvB,2CAA2C;EAC3C,4BAA4B;EAC5B,+BAA+B;EAC/B,qBAAqB;EACrB,iBAAiB;EACjB,sBAAsB;EACtB,uCAAuC;EACvC,mDAAmD;AACrD;;AAEA;EACE,iBAAiB;AACnB",sourcesContent:[".jp-FontsEditor {\n  color: var(--jp-ui-font-color0);\n  overflow-y: auto;\n  background-color: var(--jp-layout-color1);\n}\n\n.jp-FontsEditor-button.jp-mod-styled {\n  font-size: var(--jp-ui-font-size1);\n  background-color: var(--jp-layout-color0);\n  border: solid 1px transparent;\n  white-space: nowrap;\n  flex: 0;\n}\n\n.jp-FontsEditor .lm-CommandPalette-header {\n  margin: 0;\n}\n\n.jp-FontsEditor-enable label {\n  margin: calc(var(--jp-ui-font-size1) / 2) 0 0 var(--jp-ui-font-size1);\n  font-size: var(--jp-ui-font-size1);\n  display: flex;\n  flex-direction: row;\n  align-items: center;\n}\n\n.jp-FontsEditor-button.jp-mod-styled:focus,\n.jp-FontsEditor-button.jp-mod-styled:hover {\n  border-color: var(--jp-border-color1);\n}\n\n.jp-FontsEditor h2 {\n  padding: var(--jp-ui-font-size1);\n  margin: 0;\n  display: flex;\n}\n\n.jp-FontsEditor h2 > label {\n  flex: 1;\n}\n\n.jp-FontsEditor-delete-icon.jp-FontsEditor-button.jp-mod-styled {\n  background-repeat: no-repeat;\n  background-position: center;\n  color: transparent;\n}\n\n.jp-FontsEditor h2 .jp-NotebookIcon {\n  width: var(--jp-ui-font-size2);\n  height: calc(var(--jp-ui-font-size2));\n  display: inline-block;\n  vertical-align: middle;\n  background-repeat: no-repeat;\n}\n\n.jp-FontsEditor-embed {\n  padding: 0;\n  margin: 0;\n}\n\n.jp-FontsEditor-embed li {\n  display: flex;\n  flex-direction: row;\n  list-style: none;\n  align-items: baseline;\n  justify-content: space-between;\n  margin: 0 var(--jp-ui-font-size1);\n}\n\n.jp-FontsEditor-embed li > * {\n  flex: 1;\n  font-size: var(--jp-ui-font-size1);\n}\n\n.jp-FontsEditor-embed li > .jp-FontsEditor-size {\n  flex: 0;\n  padding: 0 var(--jp-ui-font-size1);\n  font-size: var(--jp-ui-font-size0);\n  color: var(--jp-ui-font-color2);\n  white-space: nowrap;\n}\n\n.jp-FontsEditor-field {\n  display: flex;\n  margin: 0 var(--jp-ui-font-size1);\n  align-items: baseline;\n}\n\n.jp-FontsEditor-field label {\n  white-space: nowrap;\n  flex: 0;\n  font-size: var(--jp-ui-font-size1);\n  padding-right: var(--jp-ui-font-size1);\n}\n\n.jp-FontsEditor-field > div {\n  display: flex;\n  flex: 1;\n  flex-direction: row;\n  align-items: baseline;\n}\n.jp-FontsEditor-field > div * {\n  display: block;\n  flex: 1;\n  text-align: right;\n  font-size: var(--jp-ui-font-size1);\n}\n\n.jp-FontsEditor-field select {\n  font-weight: bold;\n  border: none;\n  background: transparent;\n  background-image: var(--jp-ui-select-caret);\n  background-repeat: no-repeat;\n  background-position: 99% center;\n  background-size: 18px;\n  text-align: right;\n  text-align-last: right;\n  margin-left: var(--jp-notebook-padding);\n  padding-right: calc(2 * var(--jp-notebook-padding));\n}\n\n.jp-FontsEditor option {\n  text-align: right;\n}\n"],sourceRoot:""}]);const l=a},599:(e,t,n)=>{n.d(t,{Z:()=>l});var o=n(584),s=n.n(o),i=n(51),a=n.n(i)()(s());a.push([e.id,"","",{version:3,sources:[],names:[],mappings:"",sourceRoot:""}]);const l=a},432:(e,t,n)=>{n.d(t,{Z:()=>l});var o=n(584),s=n.n(o),i=n(51),a=n.n(i)()(s());a.push([e.id,".jp-LicenseViewer-wrapper {\n  display: flex;\n  flex-direction: column;\n}\n\n.jp-LicenseViewer {\n  flex: 1;\n  display: flex;\n  flex-direction: column;\n  padding: var(--jp-notebook-padding);\n  color: var(--jp-ui-font-color0);\n  height: 100%;\n}\n\n.jp-LicenseViewer h1,\n.jp-LicenseViewer h2 {\n  flex: 0;\n  margin: var(--jp-notebook-padding) 0;\n}\n\n.jp-LicenseViewer h2 {\n  color: var(--jp-ui-font-color1);\n}\n\n.jp-LicenseViewer pre {\n  flex: 1;\n  overflow-y: auto;\n  font-size: 80%;\n}\n","",{version:3,sources:["webpack://./style/license.css"],names:[],mappings:"AAAA;EACE,aAAa;EACb,sBAAsB;AACxB;;AAEA;EACE,OAAO;EACP,aAAa;EACb,sBAAsB;EACtB,mCAAmC;EACnC,+BAA+B;EAC/B,YAAY;AACd;;AAEA;;EAEE,OAAO;EACP,oCAAoC;AACtC;;AAEA;EACE,+BAA+B;AACjC;;AAEA;EACE,OAAO;EACP,gBAAgB;EAChB,cAAc;AAChB",sourcesContent:[".jp-LicenseViewer-wrapper {\n  display: flex;\n  flex-direction: column;\n}\n\n.jp-LicenseViewer {\n  flex: 1;\n  display: flex;\n  flex-direction: column;\n  padding: var(--jp-notebook-padding);\n  color: var(--jp-ui-font-color0);\n  height: 100%;\n}\n\n.jp-LicenseViewer h1,\n.jp-LicenseViewer h2 {\n  flex: 0;\n  margin: var(--jp-notebook-padding) 0;\n}\n\n.jp-LicenseViewer h2 {\n  color: var(--jp-ui-font-color1);\n}\n\n.jp-LicenseViewer pre {\n  flex: 1;\n  overflow-y: auto;\n  font-size: 80%;\n}\n"],sourceRoot:""}]);const l=a},404:(e,t,n)=>{n.d(t,{y:()=>d});var o=n(169),s=n(923),i=n(840),a=n(962),l=n(87);class d{constructor(){this.widgetRequested=new i.Signal(this)}createNew(e,t){let n=new o.ToolbarButton({icon:a.U.fonts,onClick:()=>{this.widgetRequested.emit(void 0)},tooltip:"Customize Notebook Fonts"});const i=e=>{e.get(l.dj)?n.addClass(l.XU):n.removeClass(l.XU)},d=e.model;return d&&(d.metadata.changed.connect(i),i(d.metadata)),e.toolbar.insertItem(9,"fonts",n),new s.DisposableDelegate((()=>{d&&d.metadata.changed.disconnect(i),n.dispose()}))}}},962:(e,t,n)=>{n.d(t,{U:()=>s});var o=n(978);const s={fonts:new o.LabIcon({name:"fonts:fonts",svgstr:'<svg xmlns="http://www.w3.org/2000/svg" baseProfile="tiny" width="24" height="24" viewBox="0 0 24 24">\n  <g class="jp-icon3" fill="#616161">\n    <rect x="1" y="1" width="22" height="22" rx="2" ry="2"/>\n  </g>\n  <g class="jp-icon-accent0 jp-icon-selectable" fill="#fff">\n    <text text-anchor="middle" x="12px" font-family="sans-serif" alignment-baseline="middle" y="17px">Aa</text>\n  </g>\n</svg>\n'}),license:new o.LabIcon({name:"fonts:license",svgstr:'<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="24" height="24" viewBox="0 0 24 24">\n  <defs>\n    <path id="a" d="M24 0v24H0V0h24z" />\n  </defs>\n  <clipPath id="b">\n    <use xlink:href="#a" overflow="visible" />\n  </clipPath>\n  <g class="jp-icon3" fill="#616161">\n    <circle cx="12" cy="12" r="10" fill="rgba(255,255,255,0.5)"></circle>\n  </g>\n  <g class="jp-icon-accent0 jp-icon-selectable" fill="#fff">\n    <path d="M10.08 10.86c.05-.33.16-.62.3-.87s.34-.46.59-.62c.24-.15.54-.22.91-.23.23.01.44.05.63.13.2.09.38.21.52.36s.25.33.34.53.13.42.14.64h1.79c-.02-.47-.11-.9-.28-1.29s-.4-.73-.7-1.01-.66-.5-1.08-.66-.88-.23-1.39-.23c-.65 0-1.22.11-1.7.34s-.88.53-1.2.92-.56.84-.71 1.36S8 11.29 8 11.87v.27c0 .58.08 1.12.23 1.64s.39.97.71 1.35.72.69 1.2.91 1.05.34 1.7.34c.47 0 .91-.08 1.32-.23s.77-.36 1.08-.63.56-.58.74-.94.29-.74.3-1.15h-1.79c-.01.21-.06.4-.15.58s-.21.33-.36.46-.32.23-.52.3c-.19.07-.39.09-.6.1-.36-.01-.66-.08-.89-.23-.25-.16-.45-.37-.59-.62s-.25-.55-.3-.88-.08-.67-.08-1v-.27c0-.35.03-.68.08-1.01zM12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm0 18c-4.41 0-8-3.59-8-8s3.59-8 8-8 8 3.59 8 8-3.59 8-8 8z" clip-path="url(#b)" />\n  </g>\n</svg>\n'})}},90:(e,t,n)=>{n.d(t,{$:()=>d});var o=n(169),s=n(271),i=n(62),a=n.n(i),l=n(432);a()(l.Z,{insert:"head",singleton:!1}),l.Z.locals;class d extends o.VDomRenderer{constructor(e){super(new d.Model(e))}render(){this.addClass("jp-LicenseViewer-wrapper");let e=this.model;if(!e)return s.createElement(s.Fragment,null);const t=e.licenseText?s.createElement("pre",null,e.licenseText):s.createElement(s.Fragment,null);return s.createElement("div",{className:"jp-LicenseViewer"},s.createElement("h1",null,e.font.name),s.createElement("h2",null,e.font.license.name),t)}}!function(e){class t extends o.VDomModel{constructor(e){super(),this.font=e.font}get font(){return this._font}set font(e){this._font=e,this.stateChanged.emit(void 0),this._licenseTextPromise=new Promise(((e,t)=>{this._font.license.text().then((t=>{this._licenseText=t,this.stateChanged.emit(void 0),e(this._licenseText)})).catch((e=>{t(e)}))}))}get licenseText(){return this._licenseText}get licenseTextPromise(){return this._licenseTextPromise}}e.Model=t}(d||(d={}))},337:(e,t,n)=>{n.d(t,{Q:()=>c});var o=n(526),s=n(840),i=n(992),a=n(964),l=n(87),d=n(901);const r={code:"Fonts (Code)",content:"Fonts (Content)"};class c{constructor(e,t,n){this.licensePaneRequested=new s.Signal(this),this._fontFamilyMenus=new Map,this._fontSizeMenus=new Map,this._lineHeightMenus=new Map,this._ready=new o.PromiseDelegate,this._stylist=new a.k,this._stylist.cacheUpdated.connect(this.settingsUpdate,this),this._commands=e,this._palette=t,this._notebooks=n,this._notebooks.currentChanged.connect(this._onNotebooksChanged,this),this.makeMenus(e),this.makeCommands(),this.hack()}get ready(){return this._ready.promise}get fonts(){return this._stylist.fonts}get enabled(){return!!this.settings&&!!this._settings.get("enabled").composite}set enabled(e){this.settings&&this._settings.set("enabled",e).then().catch(console.warn)}get menu(){return this._menu}get stylesheets(){return this._stylist.stylesheets}get settings(){return this._settings}set settings(e){this._settings&&this._settings.changed.disconnect(this.settingsUpdate,this),this._settings=e,e&&e.changed.connect(this.settingsUpdate,this),this.settingsUpdate()}setTransientNotebookStyle(e,t){this._stylist.setTransientNotebookStyle(e,t)}getTransientNotebookStyle(e){return this._stylist.getTransientNotebookStyle(e)}async dataURISrc(e,t=l.Km.woff2){return await(0,d.gm)(e,t)}registerFontFace(e){this._stylist.fonts.set(e.name,e),this.registerFontCommands(e)}getVarName(e,{kind:t}){return null==t?null:l.ux[t][e]}getTextStyle(e,{kind:t,notebook:n}){if(!n&&!this.settings)return null;try{const o=(null==n?void 0:n.model)?n.model.metadata.get(l.dj).styles:this._settings.get("styles").composite;let s=this.getVarName(e,{kind:t});if(null!=o){const e=o[l.Dx];return null==e?null:e[s]}}catch(e){}return null}async setTextStyle(e,t,{kind:n,notebook:o}){var s,i;if(!o&&!this.settings)return;let a;const d=null==o?void 0:o.model;try{a=d?d.metadata.get(l.dj).styles:this._settings.get("styles").user}catch(e){a={}}let r=JSON.parse(JSON.stringify(a||{})),c=r[l.Dx]=r[l.Dx]?r[l.Dx]:{},h=this.getVarName(e,{kind:n});if(c&&(null==t?delete c[h]:c[h]=t),o){let n=(null===(s=o.model)||void 0===s?void 0:s.metadata.get(l.dj))||{};n=JSON.parse(JSON.stringify(n)),n.styles=r,"font-family"===e&&null!=t&&await this.embedFont(t,n),this.cleanMetadata(n),null===(i=o.model)||void 0===i||i.metadata.set(l.dj,n)}else{Object.keys(r[l.Dx]||{}).length||delete r[l.Dx];try{await this._settings.set("styles",r)}catch(e){console.warn(e)}}}cleanMetadata(e){const t=JSON.stringify(e.styles,null,2),n=Object.keys(e.fonts||{});for(let o of n){let n=`'${o}'`;-1===t.indexOf(n)&&(e.fonts&&delete e.fonts[o],e.fontLicenses&&delete e.fontLicenses[o])}}async embedFont(e,t){if(null==e)return;const n=e.replace(/(['"]?)(.*)\1/,"$2"),o=this._stylist.fonts.get(n);if(o)try{const e=await o.faces(),s=t.fonts||{},i=t.fontLicenses||{};s[n]=e,i[n]={spdx:o.license.spdx,name:o.license.name,text:await o.license.text(),holders:o.license.holders},t.fonts=s,t.fontLicenses=i}catch(e){console.warn("error embedding font"),console.warn(e)}}_onNotebooksChanged(){let e=this._stylist.notebooks();this._notebooks.forEach((t=>{-1===e.indexOf(t)&&this._registerNotebook(t)}))}_registerNotebook(e){this._stylist.registerNotebook(e,!0);let t=this._notebookMetaWatcher(e);(null==e?void 0:e.model)&&e.model.metadata.changed.connect(t),e.disposed.connect(this._onNotebookDisposed,this),t(),this.hack()}_onNotebookDisposed(e){this._stylist.registerNotebook(e,!1)}_notebookMetaWatcher(e){return()=>{this._notebooks.forEach((t=>{if(t.id!==e.id||!t.model)return;const n=t.model.metadata.get(l.dj);n&&this._stylist.stylesheet(n,t)}))}}fontSizeOptions(){return Array.from(Array(25).keys()).map((e=>`${e+8}px`))}fontSizeCommands(e){return this.fontSizeOptions().map((t=>`${e}:${t}`))}makeCommands(){[l.$4.code,l.$4.content].map((e=>{["Increase","Decrease"].map(((t,n)=>{var o;let s=`${l.e_[e].fontSize}:${t.toLowerCase()}`;this._commands.addCommand(s,{label:`${t} Code Font Size`,execute:async()=>{let t=this.getTextStyle("font-size",{kind:e}),o=parseInt((t||"0").replace(/px$/,""),10)||13;try{await this.setTextStyle("font-size",`${o+(n?-1:1)}px`,{kind:e})}catch(e){console.warn(e)}},isVisible:()=>this.enabled}),null===(o=this._fontSizeMenus.get(e))||void 0===o||o.addItem({command:s}),this._palette.addItem({command:s,category:r[e],rank:0})})),["line-height","font-size","font-family"].forEach((t=>{const n=`${e}-${t}:-reset`;this._commands.addCommand(n,{label:`Default ${e[0].toUpperCase()}${e.slice(1)} ${l.Tr[t]}`,execute:()=>this.setTextStyle(t,null,{kind:e}),isVisible:()=>this.enabled,isToggled:()=>null==this.getTextStyle(t,{kind:e})})})),l.pf["line-height"](this).map((t=>{var n;const o=`${l.e_[e].lineHeight}:${t}`;this._commands.addCommand(o,{label:`${t}`,isToggled:()=>this.getTextStyle("line-height",{kind:e})===t,isVisible:()=>this.enabled,execute:()=>this.setTextStyle("line-height",t,{kind:e})}),null===(n=this._lineHeightMenus.get(e))||void 0===n||n.addItem({command:o})})),l.pf["font-size"](this).map((t=>{var n;const o=`${l.e_[e].fontSize}:${t}`;this._commands.addCommand(o,{label:`${t}`,isToggled:()=>this.getTextStyle("font-size",{kind:e})===t,isVisible:()=>this.enabled,execute:()=>this.setTextStyle("font-size",t,{kind:e})}),null===(n=this._fontSizeMenus.get(e))||void 0===n||n.addItem({command:o})}))})),["Enable","Disable"].map(((e,t)=>{const n=`custom-fonts:${e.toLowerCase()}`;this._commands.addCommand(n,{label:`${e} Custom Fonts`,isVisible:()=>this.enabled===!!t,execute:async()=>{if(this._settings)try{await this._settings.set("enabled",!t)}catch(e){console.warn(e)}}}),this._palette.addItem({command:n,category:"Fonts"})}))}fontPropMenu(e,t,n){let o=new i.Menu({commands:e.commands});return o.title.label=l.Tr[n],o.addItem({command:`${t}-${n}:-reset`}),o.addItem({type:"separator"}),e.addItem({type:"submenu",submenu:o}),o}makeMenus(e){this._menu=new i.Menu({commands:e}),this._menu.title.label="Fonts",[l.$4.code,l.$4.content].map((t=>{const n=new i.Menu({commands:e});n.title.label=t[0].toUpperCase()+t.slice(1),this._menu.addItem({type:"submenu",submenu:n});const o=this.fontPropMenu(n,t,"font-family"),s=this.fontPropMenu(n,t,"line-height"),a=this.fontPropMenu(n,t,"font-size");this._fontFamilyMenus.set(t,o),this._lineHeightMenus.set(t,s),this._fontSizeMenus.set(t,a)})),this._menu.addItem({command:l.e_.editFonts,args:{global:!0}}),this._menu.addItem({command:l.e_.customFonts.enable}),this._menu.addItem({command:l.e_.customFonts.disable})}settingsUpdate(){let e={styles:this._settings.get("styles").composite};this.enabled?this._stylist.stylesheet(e,void 0,!0):this._stylist.hack(!1)}registerFontCommands(e){[l.$4.code,l.$4.content].forEach((t=>{var n;const o=e.name.replace(/[^a-z\d]/gi,"-").toLowerCase();let s=`${l.e_[t].fontFamily}:${o}`;this._commands.addCommand(s,{label:e.name,isToggled:()=>`${this.getTextStyle("font-family",{kind:t})}`.indexOf(`'${e.name}'`)>-1,isVisible:()=>this.enabled,execute:async()=>{try{await this.setTextStyle("font-family",`'${e.name}'`,{kind:t})}catch(e){console.warn(e)}}}),null===(n=this._fontFamilyMenus.get(t))||void 0===n||n.addItem({command:s}),this._palette.addItem({command:s,category:r[t]})}))}requestLicensePane(e){this.licensePaneRequested.emit(e)}hack(){this._stylist.hack(),this._ready.resolve(void 0)}}},662:(e,t,n)=>{n.r(t),n.d(t,{default:()=>x});var o=n(169),s=n(634),i=n(165),a=n(411),l=n(404),d=n(271),r=n(87),c=n(62),h=n.n(c),m=n(602);h()(m.Z,{insert:"head",singleton:!1}),m.Z.locals;const f=d.createElement,p="lm-CommandPalette-header",A="jp-FontsEditor-button jp-mod-styled",g="-";class u extends o.VDomModel{get fonts(){return this._fonts}set fonts(e){this._fonts&&this._fonts.settings&&this._fonts.settings.changed.disconnect(this.onSettingsChange,this),this._fonts=e,e.settings.changed.connect(this.onSettingsChange,this),this.stateChanged.emit(void 0)}onSettingsChange(){this.stateChanged.emit(void 0)}get notebook(){return this._notebook}set notebook(e){var t,n;(null===(t=this._notebook)||void 0===t?void 0:t.model)&&(this._notebook.model.metadata.changed.disconnect(this.onSettingsChange,this),this._notebook.context.pathChanged.disconnect(this.onSettingsChange,this)),this._notebook=e,(null===(n=this._notebook)||void 0===n?void 0:n.model)&&(this._notebook.model.metadata.changed.connect(this.onSettingsChange,this),this._notebook.context.pathChanged.connect(this.onSettingsChange,this)),this.stateChanged.emit(void 0)}get enabled(){return this._fonts.enabled}async setEnabled(e){null==this.notebook&&(await this._fonts.settings.set("enabled",e),this.stateChanged.emit(void 0))}get notebookMetadata(){var e;if(null===(e=this.notebook)||void 0===e?void 0:e.model)return this.notebook.model.metadata.get(r.dj)}clearNotebookMetadata(e){var t;let n=this.notebookMetadata;e&&((null==n?void 0:n.fonts)&&delete n.fonts[e],(null==n?void 0:n.fontLicenses)&&delete n.fontLicenses[e]),(null===(t=this.notebook)||void 0===t?void 0:t.model)&&this.notebook.model.metadata.set(r.dj,JSON.parse(JSON.stringify(n))),this.stateChanged.emit(void 0)}dispose(){this._fonts&&this._fonts.settings&&this._fonts.settings.changed.disconnect(this.onSettingsChange,this),super.dispose()}}class b extends o.VDomRenderer{constructor(){super(new u),this.addClass("jp-FontsEditor")}render(){return this.model?f("div",{key:"editor"},[...this.header(),...[r.$4.code,r.$4.content].map((e=>f("section",{key:`${e}-section`,title:r.ZM[e]},[f("h3",{key:`${e}-header`,className:p},r.ZM[e]),...["font-family","font-size","line-height"].map((t=>this.textSelect(t,e,{key:`${e}-${t}`})))])))]):f("div",{key:"empty"})}fontFaceExtras(e,t){let n,o=`${t}`.slice(1,-1);return e.fonts.fonts.get(o)&&(n=e.fonts.fonts.get(o)),n?[this.licenseButton(e,n)]:[]}licenseButton(e,t){return f("button",{className:A,title:t.license.name,key:t.name,onClick:()=>e.fonts.requestLicensePane(t)},t.license.spdx)}textSelect(e,t,n){const o=this.model,s=o.fonts.getTextStyle(e,{kind:t,notebook:o.notebook||void 0}),i="font-family"===e?this.fontFaceExtras(o,s):[];return f("div",Object.assign({className:"jp-FontsEditor-field",key:"select-field"},n),[f("label",{key:"select-label"},r.Tr[e]),f("div",{key:"select-wrap"},[...i,f("select",{className:"jp-mod-styled",title:`${r.Tr[e]}`,onChange:n=>{let s=n.target.value;s=s===g?null:s,o.fonts.setTextStyle(e,s,Object.assign({kind:t},o.notebook?{notebook:o.notebook}:{})).catch(console.warn)},defaultValue:s||g,key:"select"},[null,...r.pf[e](o.fonts)].map((t=>f("option",{key:`'${t}'`,value:null==t?g:"font-family"===e?`'${t}'`:t},t||g))))])])}deleteButton(e,t){return f("button",{className:A,title:"Delete Embedded Font",key:"delete",onClick:async()=>{(await(0,o.showDialog)({title:"Delete Embedded Font from Notebook",body:`If you dont have ${t} installed, you might not be able to re-embed it`,buttons:[o.Dialog.cancelButton(),o.Dialog.warnButton({label:"DELETE"})]})).button.accept&&e.clearNotebookMetadata(t)}},"Delete")}enabler(e){return f("label",{key:"enable-label"},f("span",{key:"enable-text"},"Enabled"),f("input",{key:"enable-input",type:"checkbox",checked:e.enabled,onChange:async t=>{await e.setEnabled(!!t.currentTarget.checked)}}))}embeddedFont(e,t){var n;if(null==(null===(n=e.notebookMetadata)||void 0===n?void 0:n.fonts)||null==e.notebookMetadata.fontLicenses)return null;const o=e.notebookMetadata.fonts[t],s=e.notebookMetadata.fontLicenses[t],i=(o||[]).reduce(((e,t)=>e+`${t.src}`.length),s.text.length),a=parseInt(""+i/1024,10);return f("li",{key:t},[f("label",{key:"label"},t),this.licenseButton(e,{name:t,license:{name:s.name,spdx:s.spdx,text:async()=>s.text,holders:s.holders},faces:async()=>o||[]}),f("span",{className:"jp-FontsEditor-size",key:"font-kb"},`${a} kb`),this.deleteButton(e,t)])}header(){var e;const t=this.model,n=t.notebook?null===(e=t.notebook.context.contentsModel)||void 0===e?void 0:e.name.replace(/.ipynb$/,""):"Global";this.title.label=n||"Unknown";const o=f("h2",{key:"scope-head"},[f("label",{key:"scope-label"},`Fonts Â» ${n}`),...t.notebook?[f("div",{className:"jp-NotebookIcon",key:"scope-icon"})]:[]]);return null!=t.notebook?[o,f("section",{key:"embed-section"},[f("h3",{className:p,key:"embed-head"},"Embedded fonts"),f("ul",{className:"jp-FontsEditor-embed",key:"embeds"},Object.keys((t.notebookMetadata||{}).fonts||{}).map((e=>this.embeddedFont(t,e))))])]:[o,f("section",{key:"enable-section",className:"jp-FontsEditor-enable"},[f("h3",{className:p,key:"enable-header"},"Enable/Disable All Fonts"),this.enabler(t)])]}}var y=n(962),C=n(90),k=n(337),E=n(599);h()(E.Z,{insert:"head",singleton:!1}),E.Z.locals;const j=`${r.dj}:fonts`;let v=0;const _={id:j,autoStart:!0,requires:[s.IMainMenu,a.ISettingRegistry,o.ICommandPalette,i.INotebookTracker],provides:r.As,activate:function(e,t,n,o,s){const i=new k.Q(e.commands,o,s);i.licensePaneRequested.connect(((t,n)=>{let o=new C.$({font:n});o.id="jp-fonts-license-"+v++,o.title.label=n.name,o.title.closable=!0,o.title.icon=y.U.license,e.shell.add(o,"main"),e.shell.activateById(o.id)})),t.settingsMenu.addGroup([{type:"submenu",submenu:i.menu}]),e.commands.addCommand(r.e_.editFonts,{label:"Global Fonts...",execute:t=>{const n=new b,{model:o}=n;if(o.fonts=i,n.title.icon=y.U.fonts,n.title.closable=!0,(t||{}).global)n.title.label="Global",n.id="font-editor-global";else{const{currentWidget:e}=s;if(null==e)return;o.notebook=e,n.id=`font-editor-${o.notebook.id}`,o.notebook.disposed.connect((()=>n.dispose()))}e.shell.add(n,"main",{mode:"split-right"})}});const a=new l.y;return a.widgetRequested.connect((async()=>{try{await e.commands.execute(r.e_.editFonts)}catch(e){console.warn(e)}})),e.docRegistry.addWidgetExtension("Notebook",a),Promise.all([n.load(j),e.restored]).then((async([e])=>{i.settings=e,n.load("@jupyterlab/apputils-extension:themes").then((e=>{e.changed.connect((()=>{setTimeout((()=>i.hack()),100)}))})).catch(console.warn)})).catch((e=>{console.error(e)})),i}},x=_},964:(e,t,n)=>{n.d(t,{k:()=>f});var o=n(19),s=n(526),i=n(669),a=n(840),l=n(830),d=n(604),r=n.n(d),c=n(87);const h=/^@import(.*$)/,m=/url\(\s*['"]?(\.[^\)'"]+)['"]?\s*\)/g;class f{constructor(){this.fonts=new Map,this._notebookStyles=new Map,this._transientNotebookStyles=new Map,this._jss=l.create(r()()),this._fontCache=new Map,this._cacheUpdated=new a.Signal(this),this._cellStyleCache=new Map,this._notebookCellCount=new Map,this._globalStyles=document.createElement("style"),this._globalStyles.classList.add(c.SO.sheet),this._globalStyles.classList.add(c.SO.modGlobal),this._notebookContentDebouncer=new i.dx((e=>{this._onNotebookModelContentChanged(e)}),100)}get cacheUpdated(){return this._cacheUpdated}registerNotebook(e,t){if(t){const t=document.createElement("style");this._notebookStyles.set(e,t),t.classList.add(c.SO.sheet),t.classList.add(c.SO.modNotebook),e.content.modelContentChanged.connect(this._debouncedNotebookContentChanged,this),e.disposed.connect(this._onDisposed,this),this._onNotebookModelContentChanged(e.content),this.hack()}else this._onDisposed(e)}_debouncedNotebookContentChanged(e){this._notebookContentDebouncer.invoke(e).catch(console.warn)}_onNotebookModelContentChanged(e){var t;const n=e.widgets.length;let o=n!==(this._notebookCellCount.get(e)||-1);for(const t of e.widgets){t.node.dataset.jpfCellId=t.model.id;let e=[...t.model.metadata.get("tags")||[]].join(",");if(e?t.node.dataset.jpfCellTags=`,${e},`:delete t.node.dataset.jpfCellTags,!o){const e=t.model.metadata.get(c.dj)||s.JSONExt.emptyObject;let n=this._cellStyleCache.get(t.model.id)||s.JSONExt.emptyObject;s.JSONExt.deepEqual(e,n)||(o=!0),this._cellStyleCache.set(t.model.id,e)}}o&&(this.stylesheet(null===(t=e.model)||void 0===t?void 0:t.metadata.get(c.dj),e.parent),this._notebookCellCount.set(e,n))}_onDisposed(e){var t;this._notebookStyles.has(e)&&(null===(t=this._notebookStyles.get(e))||void 0===t||t.remove(),this._notebookStyles.delete(e),e.disposed.disconnect(this._onDisposed,this),e.content.modelContentChanged.disconnect(this._debouncedNotebookContentChanged,this)),this._notebookCellCount.has(e.content)&&this._notebookCellCount.delete(e.content)}get stylesheets(){return[this._globalStyles,...Array.from(this._notebookStyles.values())]}notebooks(){return Array.from(this._notebookStyles.keys())}setTransientNotebookStyle(e,t){var n;null==t?this._transientNotebookStyles.delete(e):this._transientNotebookStyles.set(e,t);const o=null===(n=e.model)||void 0===n?void 0:n.metadata.get(c.dj);this.stylesheet(o,e)}getTransientNotebookStyle(e){return this._transientNotebookStyles.get(e)||null}stylesheet(e,t,n=!1){let o=t?this._notebookStyles.get(t):this._globalStyles,i=null,a=null,l="";if(e&&(i=t?this._nbMetaToStyle(e,t):this._settingsToStyle(e),a=this._jss.createStyleSheet(i),l=a.toString()),t){let e=this.getTransientNotebookStyle(t);e&&(i=this._nbMetaToStyle(e,t),a=this._jss.createStyleSheet(i),l=`${l.trim()}\n${a.toString()}`);for(const e of t.content.widgets){let n=e.model.metadata.get(c.dj)||s.JSONExt.emptyObject;i=this._nbMetaToStyle(n,t,e),a=this._jss.createStyleSheet(i),l=`${l.trim()}\n${a.toString()}`}}l=this._normalizeCSS(l,t),o&&o.textContent!==l&&(o.textContent=l),this.hack()}_normalizeCSS(e,t){const n=e.split("\n"),s=[],i=[];let a,l=(null==t?void 0:t.context.localPath)||null;for(a of(l&&(l=o.URLExt.join(o.PageConfig.getBaseUrl(),"files",o.PathExt.dirname(l))),n))null!=l&&(a=a.replace(m,`url('${l}/$1')`)),a.match(h)?i.push(a):s.push(a);return[...i,...s].join("\n")}_nbMetaToStyle(e,t,n=null){let o={"@font-face":[],"@global":{},"@import":[]},i=`.${c.SO.notebookPanel}[id='${t.id}']`;n&&(i=`${i} .${c.SO.cell}[data-jpf-cell-id="${n.model.id}"]`);let a=o["@global"][i]={};if(e.fonts)for(let t in e.fonts)o["@font-face"]=o["@font-face"].concat(e.fonts[t]);let l=e.styles||s.JSONExt.emptyObject;for(let e of Object.entries(l)){let[t,n]=e;switch(t){case"@import":case"@font-face":o[t].push(...Array.isArray(n)?n:[n]);break;default:if(t===c.Dx)for(let e in n)null!=l&&null!=n&&(a[e]=n[e]);else"object"==typeof n?a[`& ${t}`]=n:a[t]=n}}return o}_settingsToStyle(e){let t=JSON.stringify(e.styles),n=JSON.parse(t),o={},s=[];for(let e of Array.from(this.fonts.keys()))if(t.indexOf(`'${e}'`)>-1&&!o[e]){const t=this._fontCache.get(e);null!=t?o[e]=t:new Promise(((t,n)=>{const o=this.fonts.get(e);null!=o?o.faces().then((n=>{this._fontCache.has(e)||(this._fontCache.set(e,n),this._cacheUpdated.emit(void 0),t(void 0))})).catch(n):n()})).catch(console.warn)}let i=Object.keys(o).reduce(((e,t)=>{const n=o[t];if(o&&null!=n)return e.concat(n)}),[]),a=[],l={};for(let e of Object.entries(n)){let[t,n]=e;switch(t){case"@import":s.push(...Array.isArray(n)?n:[n]);break;case"@font-face":a.push(...Array.isArray(n)?n:[n]);break;default:l[t]=n}}return{"@global":l,"@font-face":[i,...a],"@import":s}}dispose(){this._globalStyles.remove();for(let e of Array.from(this._notebookStyles.keys()))this._onDisposed(e)}hack(e=!0){e?setTimeout((()=>this.stylesheets.map((e=>{document.body.appendChild(e)}))),0):this.stylesheets.map((e=>e.remove()))}}},87:(e,t,n)=>{n.d(t,{$4:()=>o,As:()=>u,Dx:()=>r,Km:()=>a,SO:()=>h,TP:()=>p,Tr:()=>f,Wb:()=>l,XU:()=>g,ZM:()=>i,dj:()=>A,e_:()=>d,pf:()=>m,ux:()=>c});var o,s=n(526);!function(e){e.code="code",e.content="content"}(o||(o={}));const i={code:"Code",content:"Content"};var a;!function(e){e.woff2="woff2",e.woff="woff"}(a||(a={}));const l={woff2:"font/woff2",woff:"font/woff"},d={code:{fontSize:"code-font-size",fontFamily:"code-font-family",lineHeight:"code-line-height"},content:{fontSize:"content-font-size",fontFamily:"content-font-family",lineHeight:"content-line-height"},editFonts:"font-editor:open",customFonts:{disable:"custom-fonts:disable",enable:"custom-fonts:enable"}},r=":root",c={code:{"font-family":"--jp-code-font-family","font-size":"--jp-code-font-size","line-height":"--jp-code-line-height"},content:{"font-family":"--jp-content-font-family","font-size":"--jp-content-font-size1","line-height":"--jp-content-line-height"}};var h;!function(e){e.sheet="jp-Fonts-Sheet",e.modGlobal="jp-fonts-mod-global",e.modNotebook="jp-fonts-mod-notebook",e.notebookPanel="jp-NotebookPanel",e.cell="jp-Cell"}(h||(h={}));const m={"font-size":e=>Array.from(Array(25).keys()).map((e=>`${e+8}px`)),"line-height":e=>Array.from(Array(8).keys()).map((e=>""+(.25*e+1))),"font-family":e=>{let t=Array.from(e.fonts.values()).reduce(((e,t)=>e.concat(t.name)),[]);return t.sort(((e,t)=>e.localeCompare(t))),t}},f={"font-size":"Size","line-height":"Line Height","font-family":"Font"},p={code:{fontSize:"13px",lineHeight:"1",fontFamily:'"Source Code Pro", monospace'}},A="@deathbeds/jupyterlab-fonts",g="jp-fonts-configured",u=new s.Token("@deathbeds/jupyterlab-fonts:IFontManager")},901:(e,t,n)=>{n.d(t,{gm:()=>a,h$:()=>i,j$:()=>l});var o=n(87);const s="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/";function i(e){let t,n,o,i="",a=0,l=e.length;for(;a<l;){if(t=255&e.charCodeAt(a++),a===l){i+=s.charAt(t>>2),i+=s.charAt((3&t)<<4),i+="==";break}if(n=e.charCodeAt(a++),a===l){i+=s.charAt(t>>2),i+=s.charAt((3&t)<<4|(240&n)>>4),i+=s.charAt((15&n)<<2),i+="=";break}o=e.charCodeAt(a++),i+=s.charAt(t>>2),i+=s.charAt((3&t)<<4|(240&n)>>4),i+=s.charAt((15&n)<<2|(192&o)>>6),i+=s.charAt(63&o)}return i}async function a(e,t=o.Km.woff2){return`url('data:${o.Wb[t]};charset=utf-8;base64,${i(await l(e))}') format('${t}')`}function l(e){return new Promise(((t,n)=>{const o=new XMLHttpRequest;o.open("GET",e,!0),o.overrideMimeType("text/plain; charset=x-user-defined"),o.onreadystatechange=()=>{4===o.readyState&&200===o.status&&t(o.responseText)},o.send()}))}}}]);
//# sourceMappingURL=662.b6c1133ebc16b2caba16.js.map?v=b6c1133ebc16b2caba16